<!DOCTYPE html><html lang="en" ng-app="angularIOApp" itemscope itemtype="http://schema.org/Framework"><!-- template: public/docs/_layout--><head><title>Dynamic Forms - ts</title><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Angular is a development platform for building mobile and desktop web applications"/><meta name="keywords" content="Angular, AngularJS, AngularDart, Javscript, Dart, Framework, JavaScript MVC, Google"/><meta name="robots" content="all"/><meta name="referrer" content="origin"/><meta name="viewport" id="viewport" content="width=device-width, initial-scale=1"/><meta property="og:title" content="Angular 2"/><meta property="og:image" content="/resources/images/logos/standard/shield-large.png"/><meta property="og:image:type" content="image/png"/><meta property="og:image:width" content="184"/><meta property="og:image:height" content="200"/><meta property="og:description" content="Angular is a development platform for building mobile and desktop web applications"/><meta itemprop="name" content="Angular 2"/><meta itemprop="description" content="Angular is a development platform for building mobile and desktop web applications"/><meta itemprop="image" content="https://angular.io/resources/images/logos/standard/shield-large.png"/><link rel="icon" type="image/x-icon" href="/resources/images/icons/favicon.ico"/><link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.0.0/angular-material.min.css"/><link href="https://fonts.googleapis.com/css?family=Roboto:400,300,500,400italic,700" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/><link rel="stylesheet" href="/resources/css/vendor/icomoon/style.css"/><link rel="stylesheet" href="/resources/css/vendor/animate.css"/><link rel="stylesheet" href="/resources/css/main.css"/><!-- MOBILE ICONS -->
<link rel="apple-touch-icon" sizes="57x57" href="/resources/images/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/resources/images/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/resources/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/resources/images/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/resources/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/resources/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/resources/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/resources/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/resources/images/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/resources/images/favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/resources/images/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/resources/images/favicons/manifest.json"></head><body ng-controller="AppCtrl as appCtrl" class="l-offset-nav l-offset-side-nav"><nav scroll-y-offset-element="scroll-y-offset-element" class="main-nav l-pinned-top l-layer-5"><h1><a href="/" md-button>Angular <sup>by Google</sup></a></h1><button aria-label="View Menu" ng-click="appCtrl.toggleMainMenu($event)" md-button="md-button" class="main-nav-button main-nav-mobile-trigger l-right">Site Menu <span class="icon icon-arrow-drop-down"></span></button><ul ng-class="appCtrl.showMainNav ? 'is-visible' : ''"><li class="l-left"><a class="main-nav-button" href="/features.html" md-button>Features</a></li><li class="l-left"><a class="main-nav-button" href="/docs/ts/latest/" md-button>Docs</a></li><li class="l-left"><a class="main-nav-button" href="/events.html" md-button>Events</a></li><li class="l-left"><a class="main-nav-button" href="/news.html" md-button>News</a></li><li class="l-right"><a class="main-nav-button" href="/docs/ts/latest/quickstart.html" md-button>Get Started</a></li></ul></nav><!-- Include this file ONLY when current.path[2] is defined--><nav ng-class="appCtrl.showDocsNav ? 'is-visible' : ''" class="sidenav l-pinned-left l-layer-4 l-offset-nav"><!-- SEARCH BAR--><header class="sidenav-search st-input-wrapper"><form class="st-input-inner"><label for="search-io" class="is-hidden">Search Docs</label><input type="search" id="search-io" placeholder="SEARCH DOCS..."/></form><button aria-label="View Docs Menu" ng-click="appCtrl.toggleDocsMenu($event)" md-button="md-button" class="mobile-trigger button">Docs <span class="icon icon-arrow-drop-down"></span></button></header><ul class="sidenav-links"><li class="sidenav-section no-border"><a href="/docs/ts/latest/" class="nav-title">Docs Home</a></li><!-- CORE DOCUMENTATION--><li class="sidenav-section-divider"><h3>Core Documentation</h3></li><li class="sidenav-section"><a href="/docs/ts/latest/quickstart.html" title="Get up and running with Angular 2" class="nav-title ">Quickstart</a></li><li class="sidenav-section"><a href="/docs/ts/latest/guide/" title="How to read and use this documentation" class="nav-title is-parent ">Guide<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-ordered-lists is-hidden"><ul><li class="nav-list-item "><a href="/docs/ts/latest/guide/" title="How to read and use this documentation">1. Overview</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/architecture.html" title="The basic building blocks of Angular 2 applications">2. Architecture</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/displaying-data.html" title="Interpolation and other forms of property binding help us show app data in the UI.">3. Displaying Data</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/user-input.html" title="User input triggers DOM events. We listen to those events with event bindings that funnel updated values back into our components and models.">4. User Input</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/forms.html" title="A form creates a cohesive, effective, and compelling data entry experience. An Angular form coordinates a set of data-bound user controls, tracks changes, validates input, and presents errors.">5. Forms</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/dependency-injection.html" title="Angular's dependency injection system creates and delivers dependent services &quot;just-in-time&quot;.">6. Dependency Injection</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/template-syntax.html" title="Learn how to write templates that display data and consume user events with the help of data binding.">7. Template Syntax</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/cheatsheet.html" title="A quick guide to Angular syntax. (Content is provisional and may change.)">8. Angular Cheat Sheet</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/style-guide.html" title="Write Angular 2 with style.">9. Style Guide</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/glossary.html" title="Brief definitions of the most important words in the Angular 2 vocabulary">10. Glossary</a></li></ul></div></li><li class="sidenav-section no-border"><a href="/docs/ts/latest/api/" title="API Preview" class="nav-title ">API Reference</a></li><!-- ADVANCED DOCUMENATION--><li class="sidenav-section-divider"><h3>Additional Documentation</h3></li><li class="sidenav-section"><a href="/docs/ts/latest/tutorial/" title="The Tour of Heroes tutorial takes us through the steps of creating an Angular application in TypeScript." class="nav-title is-parent ">Tutorial<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-ordered-lists is-hidden"><ul><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/" title="The Tour of Heroes tutorial takes us through the steps of creating an Angular application in TypeScript.">1. Introduction</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt1.html" title="We build a simple hero editor">2. The Hero Editor</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt2.html" title="We build a master/detail page with a list of heroes">3. Master/Detail</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt3.html" title="We refactor the master/detail view into separate components">4. Multiple Components</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt4.html" title="We create a reusable service to manage our hero data calls">5. Services</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt5.html" title="We add the Angular Component Router and learn to navigate among the views">6. Routing</a></li><li class="nav-list-item "><a href="/docs/ts/latest/tutorial/toh-pt6.html" title="We convert our service and components to use Angular's HTTP service">7. HTTP</a></li></ul></div></li><li class="sidenav-section"><a href="/docs/ts/latest/guide/ngmodule.html" title="Define application modules with @NgModule" class="nav-title is-parent ">Advanced Documentation<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-unordered-lists is-hidden"><ul><li class="nav-list-item "><a href="/docs/ts/latest/guide/ngmodule.html" title="Define application modules with @NgModule">Angular Modules (NgModule)</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/animations.html" title="A guide to Angular's animation system.">Animations</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/attribute-directives.html" title="Attribute directives attach behavior to elements.">Attribute Directives</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/browser-support.html" title="Browser support and polyfills guide.">Browser support</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/component-styles.html" title="Learn how to apply CSS styles to components.">Component Styles</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/hierarchical-dependency-injection.html" title="Angular's hierarchical dependency injection system supports nested injectors in parallel with the component tree.">Hierarchical Injectors</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/server-communication.html" title="Talk to a remote server with an HTTP Client.">HTTP Client</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/lifecycle-hooks.html" title="Angular calls lifecycle hook methods on directives and components as it creates, changes, and destroys them.">Lifecycle Hooks</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/npm-packages.html" title="Recommended npm packages, and how to specify package dependencies">Npm Packages</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/pipes.html" title="Pipes transform displayed values within a template.">Pipes</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/router.html" title="Discover the basics of screen navigation with the Angular 2 Router.">Routing &amp; Navigation</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/security.html" title="Developing for content security in Angular applications">Security</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/structural-directives.html" title="Angular has a powerful template engine that lets us easily manipulate the DOM structure of our elements.">Structural Directives</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/testing.html" title="Techniques and practices for testing an Angular 2 app">Testing</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/typescript-configuration.html" title="TypeScript configuration for Angular 2 developers">TypeScript Configuration</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/upgrade.html" title="Angular 1 applications can be incrementally upgraded to Angular 2.">Upgrading from 1.x</a></li><li class="nav-list-item "><a href="/docs/ts/latest/guide/webpack.html" title="Create your Angular 2 applications with a Webpack based tooling">Webpack: an introduction</a></li></ul></div></li><li class="sidenav-section"><a href="/docs/ts/latest/cookbook/" title="A collection of recipes for common Angular application scenarios" class="nav-title is-parent is-selected">Cookbook<img src="/resources/images/icons/ic_keyboard_arrow_down_black_24px.svg" class="inline-arrow-down-svg"/></a><div class="nav-unordered-lists"><ul><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/" title="A collection of recipes for common Angular application scenarios">Overview</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/aot-compiler.html" title="Learn how to use Ahead-of-time compilation">Ahead-of-Time Compilation</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/a1-a2-quick-reference.html" title="Learn how Angular 1 concepts and techniques map to Angular 2">Angular 1 to 2 Quick Ref</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/ngmodule-faq.html" title="Answers to frequently asked questions about @NgModule">Angular Module FAQs</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/component-communication.html" title="Share information between different directives and components">Component Interaction</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/component-relative-paths.html" title="Use relative URLs for component templates and styles.">Component-relative Paths</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/dependency-injection.html" title="Techniques for Dependency Injection">Dependency Injection</a></li><li class="nav-list-item is-selected"><a href="/docs/ts/latest/cookbook/dynamic-form.html" title="Render dynamic forms with FormGroup">Dynamic Forms</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/form-validation.html" title="Validate user's form entries">Form Validation</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/rc4-to-rc5.html" title="Migrate your RC4 app to RC5 in minutes.">RC4 to RC5 Migration</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/set-document-title.html" title="Setting the document or window title using the Title service.">Set the Document Title</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/ts-to-js.html" title="Convert Angular 2 TypeScript examples into ES5 JavaScript">TypeScript to JavaScript</a></li><li class="nav-list-item "><a href="/docs/ts/latest/cookbook/visual-studio-2015.html" title="Use Visual Studio 2015 with the QuickStart files">Visual Studio 2015 QuickStart</a></li></ul></div></li></ul><!-- DROPDOWN BUTTON --><nav class="dropdown"><button aria-label="Select a version of Angular" md-button="md-button" ng-click="appCtrl.toggleVersionMenu($event)" class="dropdown-button">Angular 2 for TypeScript  <span class="icon icon-arrow-drop-down"></span></button><div ng-click="appCtrl.toggleVersionMenu($event)" ng-show="appCtrl.showMenu" class="overlay ng-hide"></div><!-- DROPDOWN MENU --><ul ng-class="appCtrl.showMenu ? 'is-visible' : ''" class="dropdown-menu"><li><a href="/docs/ts/latest/cookbook/dynamic-form.html" md-button>Angular 2 for TypeScript </a></li><li><a href="/docs/js/latest/cookbook/dynamic-form.html" md-button>Angular 2 for JavaScript </a></li><li><a href="/docs/dart/latest/cookbook/dynamic-form.html" md-button>Angular 2 for Dart </a></li></ul></nav></nav><script>// Could put in appCtrl but only needed here and clear here
(function scrollToSelectedLink() {
  var sideNav = document.getElementsByClassName('sidenav')[0];
  var link = sideNav.getElementsByClassName('is-selected')[0];
  if(link && link.offsetTop > window.innerHeight){
    sideNav.scrollTop = link.offsetTop - (window.innerHeight/2);
    //alert("offsetTop: " + link.offsetTop + " side-nav top is " + sideNav.scrollTop);
  }
})()</script><!-- template: public/_includes/_hero--><header class="hero background-sky"><h1 class="hero-title ">Dynamic Forms</h1><!--CLEAR FLOAT ELEMENTS--><div class="clear"></div></header><div class="banner"><p class="text-body">Render dynamic forms with FormGroup</p></div><article class="l-content-small grid-fluid docs-content"><script>function why(id, backTo) {
  var id = "#"+id;
  var el = document.querySelector(id);
  el.hidden=el.hidden=!el.hidden;

  if (el.hidden && backTo){
    // the next line is required to work around a bug in WebKit (Chrome / Safari)
    location.href = "#";
    location.href =  "#" + backTo;
  }
}</script><script>function verbose(isVerbose) {
  isVerbose = !! isVerbose;
  var el = document.querySelector('button.verbose.off');
  el.style.display = isVerbose ? 'block' : 'none';
  var el = document.querySelector('button.verbose.on');
  el.style.display = isVerbose ? 'none' : 'block';

  CCSStylesheetRuleStyle('main','.l-verbose-section', 'display',
    isVerbose ? 'block' : 'none');
}
</script><script>function CCSStylesheetRuleStyle(stylesheet, selectorText, style, value){
  /* returns the value of the element style of the rule in the stylesheet
  *  If no value is given, reads the value
  *  If value is given, the value is changed and returned
  *  If '' (empty string) is given, erases the value.
  *  The browser will apply the default one
  *
  * string stylesheet: part of the .css name to be recognized, e.g. 'default'
  * string selectorText: css selector, e.g. '#myId', '.myClass', 'thead td'
  * string style: camelCase element style, e.g. 'fontSize'
  * string value optional : the new value
  */
  var CCSstyle = undefined, rules, sheet;
  for(var m in document.styleSheets){
    sheet = document.styleSheets[m];
    if(sheet.href && sheet.href.indexOf(stylesheet) != -1){
    rules = sheet[document.all ? 'rules' : 'cssRules'];
    for(var n in rules){
      console.log(rules[n].selectorText);
      if(rules[n].selectorText == selectorText){
        CCSstyle = rules[n].style;
        break;
      }
    }
    break;
    }
  }
  if(value == undefined)
    return CCSstyle[style]
  else
    return CCSstyle[style] = value
}
</script><p>We can&#39;t always justify the cost and time to build handcrafted forms, 
especially if we&#39;ll need a great number of them, they&#39;re similar to each other, and they change frequently 
to meet rapidly changing business and regulatory requirements.</p>
<p>It may be more economical to create the forms dynamically, based on metadata that describe the business object model.</p>
<p>In this cookbook we show how to use <code>formGroup</code> to dynamically render a simple form with different control types and validation.
It&#39;s a primitive start. 
It might evolve to support a much richer variety of questions, more graceful rendering, and superior user experience.
All such greatness has humble beginnings.</p>
<p>In our example we use a dynamic form to build an online application experience for heroes seeking employment.
The agency is constantly tinkering with the application process.
We can create the forms on the fly <em>without changing our application code</em>. </p>
<a id="toc"></a><h2 id="table-of-contents">Table of contents</h2>
<p>   <a href="#bootstrap">Bootstrap</a></p>
<p>   <a href="#object-model">Question Model</a></p>
<p>   <a href="#form-component">Form Component</a></p>
<p>   <a href="#questionnaire-metadata">Questionnaire Metadata</a></p>
<p>   <a href="#dynamic-template">Dynamic Template</a></p>
<p><strong>See the <live-example name="cb-dynamic-form"></live-example></strong>.</p>
<div class="l-main-section"></div><a id="bootstrap"></a><h2 id="bootstrap">Bootstrap</h2>
<p>We start by creating an <code>NgModule</code> called <code>AppModule</code>.</p>
<p>In our example we will be using Reactive Forms. </p>
<p>Reactive Forms belongs to a different <code>NgModule</code> called <code>ReactiveFormsModule</code>, so in order to access any Reactive Forms directives, we have to import <code>ReactiveFormsModule</code> from <code>AppModule</code>.    </p>
<p>We bootstrap our <code>AppModule</code> in main.ts.</p>
<code-tabs><code-pane language="ts" name="app.module.ts" format="linenums">import { BrowserModule }                from &#39;@angular/platform-browser&#39;;
import { ReactiveFormsModule }          from &#39;@angular/forms&#39;;
import { NgModule }                     from &#39;@angular/core&#39;;

import { AppComponent }                 from &#39;./app.component&#39;;
import { DynamicFormComponent }         from &#39;./dynamic-form.component&#39;;
import { DynamicFormQuestionComponent } from &#39;./dynamic-form-question.component&#39;;

@NgModule({
  imports: [ BrowserModule, ReactiveFormsModule ],
  declarations: [ AppComponent, DynamicFormComponent, DynamicFormQuestionComponent ],
  bootstrap: [ AppComponent ]
})
export class AppModule {
  constructor() {
  }
}
</code-pane><code-pane language="ts" name="main.ts" format="linenums">import { platformBrowserDynamic } from &#39;@angular/platform-browser-dynamic&#39;;
import { AppModule } from &#39;./app.module&#39;;

platformBrowserDynamic().bootstrapModule(AppModule);
</code-pane></code-tabs><div class="l-main-section"></div><a id="object-model"></a><h2 id="question-model">Question Model</h2>
<p>The next step is to define an object model that can describe all scenarios needed by the form functionality.
The hero application process involves a form with a lot of questions. 
The &quot;question&quot; is the most fundamental object in the model.</p>
<p>We have created <code>QuestionBase</code> as the most fundamental question class.</p>
<div class="code-example"><header><h4>app/question-base.ts</h4></header><code-example language="ts" format="linenums">export class QuestionBase&lt;T&gt;{
  value: T;
  key: string;
  label: string;
  required: boolean;
  order: number;
  controlType: string;

  constructor(options: {
      value?: T,
      key?: string,
      label?: string,
      required?: boolean,
      order?: number,
      controlType?: string
    } = {}) {
    this.value = options.value;
    this.key = options.key || &#39;&#39;;
    this.label = options.label || &#39;&#39;;
    this.required = !!options.required;
    this.order = options.order === undefined ? 1 : options.order;
    this.controlType = options.controlType || &#39;&#39;;
  }
}
</code-example></div><p>From this base we derived two new classes in <code>TextboxQuestion</code> and <code>DropdownQuestion</code> that represent Textbox and Dropdown questions. 
The idea is that the form will be bound to specific question types and render the appropriate controls dynamically. </p>
<p><code>TextboxQuestion</code> supports multiple html5 types like text, email, url etc via the <code>type</code> property.</p>
<div class="code-example"><header><h4>app/question-textbox.ts</h4></header><code-example language="ts" format="">import { QuestionBase } from &#39;./question-base&#39;;

export class TextboxQuestion extends QuestionBase&lt;string&gt; {
  controlType = &#39;textbox&#39;;
  type: string;

  constructor(options: {} = {}) {
    super(options);
    this.type = options[&#39;type&#39;] || &#39;&#39;;
  }
}
</code-example></div><p><code>DropdownQuestion</code> presents a list of choices in a select box.</p>
<div class="code-example"><header><h4>app/question-dropdown.ts</h4></header><code-example language="ts" format="">import { QuestionBase } from &#39;./question-base&#39;;

export class DropdownQuestion extends QuestionBase&lt;string&gt; {
  controlType = &#39;dropdown&#39;;
  options: {key: string, value: string}[] = [];

  constructor(options: {} = {}) {
    super(options);
    this.options = options[&#39;options&#39;] || [];
  }
}
</code-example></div><p>Next we have defined <code>QuestionControlService</code>, a simple service for transforming our questions to a <code>FormGroup</code>. 
In a nutshell, the form group consumes the metadata from the question model and allows us to specify default values and validation rules.</p>
<div class="code-example"><header><h4>app/question-control.service.ts</h4></header><code-example language="ts" format="">import { Injectable }   from &#39;@angular/core&#39;;
import { FormControl, FormGroup, Validators } from &#39;@angular/forms&#39;;

import { QuestionBase } from &#39;./question-base&#39;;

@Injectable()
export class QuestionControlService {
  constructor() { }

  toFormGroup(questions: QuestionBase&lt;any&gt;[] ) {
    let group: any = {};

    questions.forEach(question =&gt; {
      group[question.key] = question.required ? new FormControl(question.value || &#39;&#39;, Validators.required)
                                              : new FormControl(question.value || &#39;&#39;);
    });
    return new FormGroup(group);
  }
}
</code-example></div><a id="form-component"></a><h2 id="question-form-components">Question form components</h2>
<p>Now that we have defined the complete model we are ready to create components to represent the dynamic form.</p>
<p><code>DynamicFormComponent</code> is the entry point and the main container for the form. </p>
<code-tabs><code-pane language="html" name="dynamic-form.component.html" format="linenums">&lt;div&gt;
  &lt;form (ngSubmit)=&quot;onSubmit()&quot; [formGroup]=&quot;form&quot;&gt;

    &lt;div *ngFor=&quot;let question of questions&quot; class=&quot;form-row&quot;&gt;
      &lt;df-question [question]=&quot;question&quot; [form]=&quot;form&quot;&gt;&lt;/df-question&gt;
    &lt;/div&gt;

    &lt;div class=&quot;form-row&quot;&gt;
      &lt;button type=&quot;submit&quot; [disabled]=&quot;!form.valid&quot;&gt;Save&lt;/button&gt;
    &lt;/div&gt;
  &lt;/form&gt;

  &lt;div *ngIf=&quot;payLoad&quot; class=&quot;form-row&quot;&gt;
    &lt;strong&gt;Saved the following values&lt;/strong&gt;&lt;br&gt;{{payLoad}}
  &lt;/div&gt;
&lt;/div&gt;
</code-pane><code-pane language="ts" name="dynamic-form.component.ts" format="linenums">import { Component, Input, OnInit }  from &#39;@angular/core&#39;;
import { FormGroup }                 from &#39;@angular/forms&#39;;

import { QuestionBase }              from &#39;./question-base&#39;;
import { QuestionControlService }    from &#39;./question-control.service&#39;;

@Component({
  selector: &#39;dynamic-form&#39;,
  templateUrl: &#39;app/dynamic-form.component.html&#39;,
  providers: [ QuestionControlService ]
})
export class DynamicFormComponent implements OnInit {

  @Input() questions: QuestionBase&lt;any&gt;[] = [];
  form: FormGroup;
  payLoad = &#39;&#39;;

  constructor(private qcs: QuestionControlService) {  }

  ngOnInit() {
    this.form = this.qcs.toFormGroup(this.questions);
  }

  onSubmit() {
    this.payLoad = JSON.stringify(this.form.value);
  }
}
</code-pane></code-tabs><p>It presents a list of questions, each question bound to a <code>&lt;df-question&gt;</code> component element.
The <code>&lt;df-question&gt;</code> tag matches the <code>DynamicFormQuestionComponent</code>,
the component responsible for rendering the details of each <em>individual</em> question based on values in the data-bound question object.  </p>
<code-tabs><code-pane language="html" name="dynamic-form-question.component.html" format="linenums">&lt;div [formGroup]=&quot;form&quot;&gt;
  &lt;label [attr.for]=&quot;question.key&quot;&gt;{{question.label}}&lt;/label&gt;

  &lt;div [ngSwitch]=&quot;question.controlType&quot;&gt;

    &lt;input *ngSwitchCase=&quot;&#39;textbox&#39;&quot; [formControlName]=&quot;question.key&quot;
            [id]=&quot;question.key&quot; [type]=&quot;question.type&quot;&gt;

    &lt;select [id]=&quot;question.key&quot; *ngSwitchCase=&quot;&#39;dropdown&#39;&quot; [formControlName]=&quot;question.key&quot;&gt;
      &lt;option *ngFor=&quot;let opt of question.options&quot; [value]=&quot;opt.key&quot;&gt;{{opt.value}}&lt;/option&gt;
    &lt;/select&gt;

  &lt;/div&gt; 

  &lt;div class=&quot;errorMessage&quot; *ngIf=&quot;!isValid&quot;&gt;{{question.label}} is required&lt;/div&gt;
&lt;/div&gt;
</code-pane><code-pane language="ts" name="dynamic-form-question.component.ts" format="linenums">import { Component, Input } from &#39;@angular/core&#39;;
import { FormGroup } from &#39;@angular/forms&#39;;

import { QuestionBase }     from &#39;./question-base&#39;;

@Component({
  selector: &#39;df-question&#39;,
  templateUrl: &#39;app/dynamic-form-question.component.html&#39;
})
export class DynamicFormQuestionComponent {
  @Input() question: QuestionBase&lt;any&gt;;
  @Input() form: FormGroup;
  get isValid() { return this.form.controls[this.question.key].valid; }
}
</code-pane></code-tabs><p>Notice this component can present any type of question in our model. 
We only have two types of questions at this point but we can imagine many more.
The <code>ngSwitch</code> determines which type of question to display.</p>
<p>In both components  we&#39;re relying on Angular&#39;s <strong>formGroup</strong> to connect the template HTML to the
underlying control objects, populated from the question model with display and validation rules.</p>
<p><code>formControlName</code> and <code>formGroup</code> are directives defined in <code>ReactiveFormsModule</code>. Our templates can can access these directives directly since we imported <code>ReactiveFormsModule</code> from <code>AppModule</code>.  </p>
<a id="questionnaire-metadata"></a><h2 id="questionnaire-data">Questionnaire data</h2>
<p><code>DynamicFormComponent</code> expects the list of questions in the form of an array bound to  <code>@Input() questions</code>.</p>
<p> The set of questions we have defined for the job application is returned from the <code>QuestionService</code>. 
 In a real app we&#39;d retrieve these questions from storage.</p>
<p> The key point is that we control the hero job application questions entirely through the objects returned from <code>QuestionService</code>. 
 Questionnaire maintenance is a simple matter of adding, updating, and removing objects from the <code>questions</code> array.</p>
<div class="code-example"><header><h4>app/question.service.ts</h4></header><code-example language="ts" format="linenums">import { Injectable }       from &#39;@angular/core&#39;;

import { DropdownQuestion } from &#39;./question-dropdown&#39;;
import { QuestionBase }     from &#39;./question-base&#39;;
import { TextboxQuestion }  from &#39;./question-textbox&#39;;

@Injectable()
export class QuestionService {

  // Todo: get from a remote source of question metadata
  // Todo: make asynchronous
  getQuestions() {

    let questions: QuestionBase&lt;any&gt;[] = [

      new DropdownQuestion({
        key: &#39;brave&#39;,
        label: &#39;Bravery Rating&#39;,
        options: [
          {key: &#39;solid&#39;,  value: &#39;Solid&#39;},
          {key: &#39;great&#39;,  value: &#39;Great&#39;},
          {key: &#39;good&#39;,   value: &#39;Good&#39;},
          {key: &#39;unproven&#39;, value: &#39;Unproven&#39;}
        ],
        order: 3
      }),

      new TextboxQuestion({
        key: &#39;firstName&#39;,
        label: &#39;First name&#39;,
        value: &#39;Bombasto&#39;,
        required: true,
        order: 1
      }),

      new TextboxQuestion({
        key: &#39;emailAddress&#39;,
        label: &#39;Email&#39;,
        type: &#39;email&#39;,
        order: 2
      })
    ];

    return questions.sort((a, b) =&gt; a.order - b.order);
  }
}
</code-example></div><p>Finally, we display an instance of the form in the <code>AppComponent</code> shell.</p>
<div class="code-example"><header><h4>app.component.ts</h4></header><code-example language="ts" format="linenums">import { Component }       from &#39;@angular/core&#39;;

import { QuestionService } from &#39;./question.service&#39;;

@Component({
  selector: &#39;my-app&#39;,
  template: `
    &lt;div&gt;
      &lt;h2&gt;Job Application for Heroes&lt;/h2&gt;
      &lt;dynamic-form [questions]=&quot;questions&quot;&gt;&lt;/dynamic-form&gt;
    &lt;/div&gt;
  `,
  providers:  [QuestionService]
})
export class AppComponent {
  questions: any[];

  constructor(service: QuestionService) {
    this.questions = service.getQuestions();
  }
}
</code-example></div><a id="dynamic-template"></a><h2 id="dynamic-template">Dynamic Template</h2>
<p>Although in this example we&#39;re modelling a job application for heroes, there are no references to any specific hero question 
outside the objects returned by <code>QuestionService</code>. </p>
<p>This is very important since it allows us to repurpose the components for any type of survey
as long as it&#39;s compatible with our <em>question</em> object model. 
The key is the dynamic data binding of metadata used to render the form 
without making any hardcoded assumptions about specific questions. 
In addition to control metadata, we are also adding validation dynamically.</p>
<p>The <em>Save</em> button is disabled until the form is in a valid state. 
When the form is valid, we can click <em>Save</em> and the app renders the current form values as JSON. 
This proves that any user input is bound back to the data model.
Saving and retrieving the data is an exercise for another time.</p>
<p>The final form looks like this:</p>
<figure class="image-display"><img src="/resources/images/cookbooks/dynamic-form/dynamic-form.png" alt="Dynamic-Form"></figure><p><a href="#top">Back to top</a></p></article><div class="main-footer"><nav class="background-midnight grid-fluid"><div class="c3 main-footer-branding"><div class="logo-inverse-large"></div></div><div class="c2"><h3 class="text-headline">RESOURCES</h3><ul class="text-body"><!-- TODO: (ericjim) make a libraries page to showcase all angular 2 libraries--><!--li <a href="/libraries.html">Libraries</a>--><li><a href="/about/">About</a></li><li><a href="/resources/">Books & Training</a></li><li><a href="/resources/">Tools & Libraries</a></li><li><a href="/resources/">Community</a></li><li><a href="/presskit.html">Press Kit</a></li></ul></div><div class="c2"><h3 class="text-headline">HELP</h3><ul class="text-body"><li><a href="http://stackoverflow.com/questions/tagged/angular2">Stack Overflow</a></li><li><a href="https://gitter.im/angular/angular">Gitter</a></li><li><a href="https://groups.google.com/forum/#!forum/angular"> Google Group</a></li><li><a href="https://github.com/angular/angular/issues"> Report Issues</a></li><li><a class="footer-feedback" ng-click="appCtrl.openFeedback()" aria-label="Submit feedback on this page"> Site Feedback</a></li></ul></div><div class="c2"><h3 class="text-headline">COMMUNITY</h3><ul class="text-body"><li><a href="/events.html">Events</a></li><li><a href="http://www.meetup.com/topics/angularjs/">Meetups</a></li><li><a href="https://twitter.com/angularjs"> Twitter</a></li><li><a href="https://github.com/angular/angular"> GitHub</a></li><li><a href="/contribute.html"> Contribute</a></li></ul></div><div class="c2"><h3 class="text-headline">LANGUAGES</h3><ul class="text-body"><li><a href="https://angular.cn/">中文版</a></li></ul></div></nav><footer class="background-midnight"><small class="text-caption">Powered by Google ©2010-2016. Code licensed under an <a href="/license" class="text-snow">MIT-style License</a>. Documentation licensed under <a class="text-snow" href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>.</small><a aria-label="View Style Guide" href="/docs/ts/latest/styleguide.html" title="Style Guide" class="styleguide-trigger text-snow"><span class="icon-favorite"></span></a></footer></div><!-- VENDORS --><script src="/resources/js/vendor/prettify.js"></script><script src="/resources/js/vendor/lang-basic.js"></script><script src="/resources/js/vendor/lang-dart.js"></script><script src="/resources/js/vendor/lodash.js"></script><script src="/resources/js/vendor/clipboard.min.js"></script><!-- Angular Material Dependencies --><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-animate.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-aria.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.0.0/angular-material.min.js"></script><!-- Firebase -->
<script src="https://cdn.firebase.com/js/client/2.2.4/firebase.js"></script>
<!-- AngularFire -->
<script src="https://cdn.firebase.com/libs/angularfire/1.2.0/angularfire.min.js"></script>
<!-- Angular.io Site JS --><script src="/resources/js/site.js"></script><script src="/resources/js/util.js"></script><script src="/resources/js/controllers/app-controller.js"></script><script src="/resources/js/controllers/resources-controller.js"></script><script src="/resources/js/directives/cheatsheet.js"></script><script src="/resources/js/directives/api-list.js"></script><script src="/resources/js/directives/bio.js"></script><script src="/resources/js/directives/bold.js"></script><script src="/resources/js/directives/announcement-bar.js"></script><script src="/resources/js/directives/code.js"></script><script src="/resources/js/directives/copy.js"></script><script src="/resources/js/directives/code-tabs.js"></script><script src="/resources/js/directives/code-pane.js"></script><script src="/resources/js/directives/code-example.js"></script><script src="/resources/js/directives/if-docs.js"></script><script src="/resources/js/directives/live-example.js"></script><script src="/resources/js/directives/ngio-ex-path.js"></script><script src="/resources/js/directives/scroll-y-offset-element.js"></script><!-- GA --><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-8594346-15', 'auto');
ga('send', 'pageview')

</script><!-- SWIFTYPE --><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');

_st('install','VsuU7kH5Hnnj9tfyNvfK');
</script><!-- Google Feedback --><script src="//www.gstatic.com/feedback/api.js" type="text/javascript"></script><!-- Twitter Widget --><script>(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}})(document,"script","twitter-wjs");</script></body></html>